<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.8.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Jelmer Poelstra">

  
  
  
    
  
  <meta name="description" content="In this session of Code Club, we&#39;ll look at how to avoid repetition in another way by writing your own functions.">

  
  <link rel="alternate" hreflang="en-us" href="https://biodash.github.io/codeclub/14_functions/">

  


  
  
  
  <meta name="theme-color" content="#3f51b5">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin="anonymous" title="hl-light">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin="anonymous" title="hl-dark" disabled>
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  





<script async src="https://www.googletagmanager.com/gtag/js?id=G-9F9CQ7P0DX"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'G-9F9CQ7P0DX', {});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hucc2cf774636a7e386557c89fa75ff618_191491_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hucc2cf774636a7e386557c89fa75ff618_191491_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="https://biodash.github.io/codeclub/14_functions/">

  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="BioDASH">
  <meta property="og:url" content="https://biodash.github.io/codeclub/14_functions/">
  <meta property="og:title" content="Session 14: Writing your own functions | BioDASH">
  <meta property="og:description" content="In this session of Code Club, we&#39;ll look at how to avoid repetition in another way by writing your own functions."><meta property="og:image" content="https://biodash.github.io/codeclub/14_functions/featured.jpg">
  <meta property="twitter:image" content="https://biodash.github.io/codeclub/14_functions/featured.jpg"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2021-03-16T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2021-03-17T13:05:04-04:00">
  

  



  


  


  <link rel='stylesheet' href='/css/highlight-light.css' title='hl-light'>
<link rel='stylesheet' href='/css/highlight-dark.css' title='hl-dark' disabled>



  <title>Session 14: Writing your own functions | BioDASH</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  






  


<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/"><img src="/images/logo_hu6407506e646a281542ecb299640680ce_37988_0x70_resize_lanczos_2.png" alt="BioDASH"></a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/"><img src="/images/logo_hu6407506e646a281542ecb299640680ce_37988_0x70_resize_lanczos_2.png" alt="BioDASH"></a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        
        <li class="nav-item dropdown">
          <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>Code Club</span><span class="caret"></span>
          </a>
          <div class="dropdown-menu">
            
              <a class="dropdown-item" href="/codeclub/"><span>- Sessions</span></a>
            
              <a class="dropdown-item" href="/codeclub-schedule/"><span>- Schedule</span></a>
            
              <a class="dropdown-item" href="/"><span>----------------------</span></a>
            
              <a class="dropdown-item" href="/codeclub-setup/"><span>- Computer Setup</span></a>
            
              <a class="dropdown-item" href="/codeclub-novice/"><span>- Getting Started with R</span></a>
            
              <a class="dropdown-item" href="/codeclub-present/"><span>- For Presenters</span></a>
            
              <a class="dropdown-item" href="/"><span>-----------------------</span></a>
            
              <a class="dropdown-item" href="/codeclub-suggest/"><span>- Suggest a Topic</span></a>
            
              <a class="dropdown-item" href="/codeclub-about/"><span>- About & Join!</span></a>
            
          </div>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/events/"><span>Other Events</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/material/"><span>Material</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/support/"><span>Support</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/suggest/"><span>Suggest...</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/about/"><span>About</span></a>
        </li>

        
        

        

        
        
        
          
            
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="https://github.com/biodash/biodash.github.io" target="_blank" rel="noopener"><i class='fab fa-github'></i><span></span></a>
        </li>

        
        

        

        
        
        
          
            
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/index.xml" target="_blank" rel="noopener"><i class='fas fa-rss'></i><span></span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      <li class="nav-item">
        <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
      </li>
      

      

    </ul>

  </div>
</nav>


  
  <div class="container-fluid docs">
      <div class="row flex-xl-nowrap">
        <div class="d-none d-xl-block col-xl-2 docs-toc">
          <ul class="nav toc-top">
            <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
          </ul>
          <nav id="TableOfContents">
  <ul>
    <li><a href="#new-to-code-club">New To Code Club?</a></li>
    <li><a href="#session-goals">Session Goals</a></li>
    <li><a href="#writing-your-own-functions">Writing your own functions</a>
      <ul>
        <li><a href="#functions-in-for-loops">Functions in <code>for</code> loops</a></li>
      </ul>
    </li>
    <li><a href="#functional-programming-with-your-own-functions">Functional programming with your own functions</a>
      <ul>
        <li><a href="#lapply"><code>lapply()</code></a></li>
        <li><a href="#map"><code>map()</code></a></li>
        <li><a href="#advantages-of-using-functions">Advantages of using functions</a></li>
      </ul>
    </li>
  </ul>
</nav>
          
        </div>
        <main class="col-12 col-md-0 col-xl-10 py-md-3 pl-md-5 docs-content" role="main">
  

  <article class="article">
  
    




















  
  
    
  


<div class="article-container pt-3">
  <h1>Session 14: Writing your own functions</h1>

  

  



<div class="article-metadata">

  
  
  
  
  <div>
    

  
  <span><a href="/authors/michael-broe/">Michael Broe</a></span>
  </div>
  
  

  
  <span class="article-date">
    
    
    Mar 17, 2021
  </span>
  

  

  

  
  
  
  
  

  
  

</div>

  














</div>


<div class="article-header article-container featured-image-wrapper mt-4 mb-4" style="max-width: 720px; max-height: 674px;">
  <div style="position: relative">
    <img src="/codeclub/14_functions/featured_hu7fba9da1679ce4a56c592454604cb9c1_119281_720x0_resize_q90_lanczos.jpg" alt="" class="featured-image">
    
  </div>
</div>


    
    <div class="article-container">
      <div class="article-style">
        <p><br> <br> <br></p>
<hr>
<h2 id="new-to-code-club">New To Code Club?</h2>
<ul>
<li>
<p>First, check out the 
<a href="/codeclub-setup/">Code Club Computer Setup</a> instructions, which also has some pointers that might be helpful if you&rsquo;re new to R or RStudio.</p>
</li>
<li>
<p>Please open RStudio before Code Club to test things out &ndash; if you run into issues, join the Zoom call early and we&rsquo;ll troubleshoot.</p>
</li>
</ul>
<hr>
<h2 id="session-goals">Session Goals</h2>
<ul>
<li>Learn another way to avoid repetition in your code by creating your own functions.</li>
<li>Learn the basic <strong>template</strong> of a function in R.</li>
<li>Learn to incorporate your own functions into <code>for</code> loops and functionals.</li>
<li>Learn all the advantages of using functions instead of code blocks.</li>
</ul>
<hr>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='kr'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='o'>(</span><span class='nv'><a href='http://tidyverse.tidyverse.org'>tidyverse</a></span><span class='o'>)</span>

<span class='c'>#&gt; ── <span style='font-weight: bold;'>Attaching packages</span><span> ─────────────────────────────────────── tidyverse 1.3.0 ──</span></span>

<span class='c'>#&gt; <span style='color: #00BB00;'>✔</span><span> </span><span style='color: #0000BB;'>ggplot2</span><span> 3.3.2     </span><span style='color: #00BB00;'>✔</span><span> </span><span style='color: #0000BB;'>purrr  </span><span> 0.3.4</span></span>
<span class='c'>#&gt; <span style='color: #00BB00;'>✔</span><span> </span><span style='color: #0000BB;'>tibble </span><span> 3.0.4     </span><span style='color: #00BB00;'>✔</span><span> </span><span style='color: #0000BB;'>dplyr  </span><span> 0.8.5</span></span>
<span class='c'>#&gt; <span style='color: #00BB00;'>✔</span><span> </span><span style='color: #0000BB;'>tidyr  </span><span> 1.0.3     </span><span style='color: #00BB00;'>✔</span><span> </span><span style='color: #0000BB;'>stringr</span><span> 1.4.0</span></span>
<span class='c'>#&gt; <span style='color: #00BB00;'>✔</span><span> </span><span style='color: #0000BB;'>readr  </span><span> 1.3.1     </span><span style='color: #00BB00;'>✔</span><span> </span><span style='color: #0000BB;'>forcats</span><span> 0.5.0</span></span>

<span class='c'>#&gt; ── <span style='font-weight: bold;'>Conflicts</span><span> ────────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span class='c'>#&gt; <span style='color: #BB0000;'>✖</span><span> </span><span style='color: #0000BB;'>dplyr</span><span>::</span><span style='color: #00BB00;'>filter()</span><span> masks </span><span style='color: #0000BB;'>stats</span><span>::filter()</span></span>
<span class='c'>#&gt; <span style='color: #BB0000;'>✖</span><span> </span><span style='color: #0000BB;'>dplyr</span><span>::</span><span style='color: #00BB00;'>lag()</span><span>    masks </span><span style='color: #0000BB;'>stats</span><span>::lag()</span></span>
</code></pre>
</div>
<h2 id="writing-your-own-functions">Writing your own functions</h2>
<p>The first motivation for writing a function is when you find yourself cut-and-pasting code blocks with slight alterations each time.</p>
<p>Say we have the following toy tidyverse data frame, where each column is a vector of 10 random numbers from a normal distribution, with <code>mean = 0</code> and <code>sd = 1</code> (the defaults for <code>rnorm</code>):</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>df</span> <span class='o'>&lt;-</span> <span class='nf'>tibble</span><span class='o'>(</span>
  a <span class='o'>=</span> <span class='nf'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='o'>(</span><span class='m'>10</span><span class='o'>)</span>,
  b <span class='o'>=</span> <span class='nf'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='o'>(</span><span class='m'>10</span><span class='o'>)</span>,
  c <span class='o'>=</span> <span class='nf'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='o'>(</span><span class='m'>10</span><span class='o'>)</span>,
  d <span class='o'>=</span> <span class='nf'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='o'>(</span><span class='m'>10</span><span class='o'>)</span>
<span class='o'>)</span>

<span class='nv'>df</span>

<span class='c'>#&gt; <span style='color: #555555;'># A tibble: 10 x 4</span></span>
<span class='c'>#&gt;          a      b       c         d</span>
<span class='c'>#&gt;      <span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>  </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>   </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>     </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span></span>
<span class='c'>#&gt; <span style='color: #555555;'> 1</span><span>  1.43    1.84  -</span><span style='color: #BB0000;'>1.06</span><span>    0.190   </span></span>
<span class='c'>#&gt; <span style='color: #555555;'> 2</span><span>  1.55    0.596  0.295  -</span><span style='color: #BB0000;'>0.000</span><span style='color: #BB0000;text-decoration: underline;'>830</span></span>
<span class='c'>#&gt; <span style='color: #555555;'> 3</span><span> -</span><span style='color: #BB0000;'>0.388</span><span>   0.357 -</span><span style='color: #BB0000;'>1.63</span><span>   -</span><span style='color: #BB0000;'>1.60</span><span>    </span></span>
<span class='c'>#&gt; <span style='color: #555555;'> 4</span><span>  0.868  -</span><span style='color: #BB0000;'>1.12</span><span>   0.098</span><span style='text-decoration: underline;'>9</span><span>  0.870   </span></span>
<span class='c'>#&gt; <span style='color: #555555;'> 5</span><span> -</span><span style='color: #BB0000;'>0.071</span><span style='color: #BB0000;text-decoration: underline;'>9</span><span> -</span><span style='color: #BB0000;'>0.665</span><span>  0.310  -</span><span style='color: #BB0000;'>0.341</span><span>   </span></span>
<span class='c'>#&gt; <span style='color: #555555;'> 6</span><span>  0.617  -</span><span style='color: #BB0000;'>0.469</span><span>  0.073</span><span style='text-decoration: underline;'>8</span><span> -</span><span style='color: #BB0000;'>0.235</span><span>   </span></span>
<span class='c'>#&gt; <span style='color: #555555;'> 7</span><span> -</span><span style='color: #BB0000;'>0.228</span><span>   0.412  0.165  -</span><span style='color: #BB0000;'>0.209</span><span>   </span></span>
<span class='c'>#&gt; <span style='color: #555555;'> 8</span><span>  1.18   -</span><span style='color: #BB0000;'>0.470</span><span> -</span><span style='color: #BB0000;'>0.175</span><span>   0.086</span><span style='text-decoration: underline;'>1</span><span>  </span></span>
<span class='c'>#&gt; <span style='color: #555555;'> 9</span><span>  1.38    0.176  0.847  -</span><span style='color: #BB0000;'>0.480</span><span>   </span></span>
<span class='c'>#&gt; <span style='color: #555555;'>10</span><span> -</span><span style='color: #BB0000;'>0.164</span><span>   1.91   0.593  -</span><span style='color: #BB0000;'>0.606</span></span>
</code></pre>
</div>
<p>In previous CodeClubs we&rsquo;ve seen how you can apply a built-in function like <code>median</code> to each column using a <code>for</code> loop or <code>apply</code>. But say we wanted to do something a bit fancier that is not part of core R. For example, we can <em>normalize</em> the values in a column so they range from 0 to 1 using the following code block:</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>a</span> <span class='o'>-</span> <span class='nf'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>a</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>/</span> <span class='o'>(</span><span class='nf'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>a</span><span class='o'>)</span> <span class='o'>-</span> <span class='nf'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>a</span><span class='o'>)</span><span class='o'>)</span>

<span class='c'>#&gt;  [1] 0.93448575 1.00000000 0.00000000 0.64688077 0.16273539 0.51751818</span>
<span class='c'>#&gt;  [7] 0.08218327 0.80535546 0.91235476 0.11515570</span>
</code></pre>
</div>
<p>This code is a literal translation of the mathematical formula for normalization:</p>
<p>$$z_{i} = \frac{x_{i} - min(x)}{max(x)-min(x)}$$ OK, so how can we do this for each column? Here is a first attempt:</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>df</span><span class='o'>$</span><span class='nv'>a</span> <span class='o'>&lt;-</span> <span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>a</span> <span class='o'>-</span> <span class='nf'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>a</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>/</span> <span class='o'>(</span><span class='nf'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>a</span><span class='o'>)</span> <span class='o'>-</span> <span class='nf'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>a</span><span class='o'>)</span><span class='o'>)</span>
<span class='nv'>df</span><span class='o'>$</span><span class='nv'>b</span> <span class='o'>&lt;-</span> <span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>b</span> <span class='o'>-</span> <span class='nf'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>a</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>/</span> <span class='o'>(</span><span class='nf'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>b</span><span class='o'>)</span> <span class='o'>-</span> <span class='nf'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>b</span><span class='o'>)</span><span class='o'>)</span>
<span class='nv'>df</span><span class='o'>$</span><span class='nv'>c</span> <span class='o'>&lt;-</span> <span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>c</span> <span class='o'>-</span> <span class='nf'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>c</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>/</span> <span class='o'>(</span><span class='nf'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>c</span><span class='o'>)</span> <span class='o'>-</span> <span class='nf'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>c</span><span class='o'>)</span><span class='o'>)</span>
<span class='nv'>df</span><span class='o'>$</span><span class='nv'>d</span> <span class='o'>&lt;-</span> <span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>d</span> <span class='o'>-</span> <span class='nf'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>d</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>/</span> <span class='o'>(</span><span class='nf'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>d</span><span class='o'>)</span> <span class='o'>-</span> <span class='nf'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>d</span><span class='o'>)</span><span class='o'>)</span>

<span class='nv'>df</span>

<span class='c'>#&gt; <span style='color: #555555;'># A tibble: 10 x 4</span></span>
<span class='c'>#&gt;         a       b     c     d</span>
<span class='c'>#&gt;     <span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>   </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span></span>
<span class='c'>#&gt; <span style='color: #555555;'> 1</span><span> 0.934   0.610  0.229 0.724</span></span>
<span class='c'>#&gt; <span style='color: #555555;'> 2</span><span> 1       0.197  0.777 0.647</span></span>
<span class='c'>#&gt; <span style='color: #555555;'> 3</span><span> 0       0.118  0     0    </span></span>
<span class='c'>#&gt; <span style='color: #555555;'> 4</span><span> 0.647  -</span><span style='color: #BB0000;'>0.370</span><span>  0.698 1    </span></span>
<span class='c'>#&gt; <span style='color: #555555;'> 5</span><span> 0.163  -</span><span style='color: #BB0000;'>0.220</span><span>  0.783 0.509</span></span>
<span class='c'>#&gt; <span style='color: #555555;'> 6</span><span> 0.518  -</span><span style='color: #BB0000;'>0.155</span><span>  0.688 0.552</span></span>
<span class='c'>#&gt; <span style='color: #555555;'> 7</span><span> 0.082</span><span style='text-decoration: underline;'>2</span><span>  0.136  0.724 0.563</span></span>
<span class='c'>#&gt; <span style='color: #555555;'> 8</span><span> 0.805  -</span><span style='color: #BB0000;'>0.155</span><span>  0.587 0.682</span></span>
<span class='c'>#&gt; <span style='color: #555555;'> 9</span><span> 0.912   0.058</span><span style='text-decoration: underline;'>1</span><span> 1     0.453</span></span>
<span class='c'>#&gt; <span style='color: #555555;'>10</span><span> 0.115   0.630  0.897 0.402</span></span>
</code></pre>
</div>
<p>This works, but it caused me mental anguish to type it out. Even with cut and paste! All those manual textual substitutions!! And manual data entry is prone to mistakes, especially repetitive tasks like this. And say you had 1,000 columns&hellip;</p>
<p><strong>And it didn&rsquo;t work!!</strong> Honestly, I swear that mistake was totally real: I didn&rsquo;t notice it until I looked at the output. Can you spot the mistake?</p>
<p>It turns out R has a <code>range</code> function that returns the minimum and maximum of a vector, which somewhat simplifies the coding:</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nf'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>a</span><span class='o'>)</span>
</code></pre>
</div>
<p>The result is a vector something like 
<a href="https://rdrr.io/r/base/c.html" target="_blank" rel="noopener"><code>c(-1.2129504, 2.1011248)</code></a> (it varies run to run, since the columns values are random) which we can index, and we so we only do the min/max computation once for each column, instead of three times, so we get the following block of code for each column:</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>rng</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>a</span><span class='o'>)</span>
<span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>a</span> <span class='o'>-</span> <span class='nv'>rng</span><span class='o'>[</span><span class='m'>1</span><span class='o'>]</span><span class='o'>)</span> <span class='o'>/</span> <span class='o'>(</span><span class='nv'>rng</span><span class='o'>[</span><span class='m'>2</span><span class='o'>]</span> <span class='o'>-</span> <span class='nv'>rng</span><span class='o'>[</span><span class='m'>1</span><span class='o'>]</span><span class='o'>)</span>
</code></pre>
</div>
<p>Does this help?</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>rng</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>a</span><span class='o'>)</span>
<span class='nv'>df</span><span class='o'>$</span><span class='nv'>a</span> <span class='o'>&lt;-</span> <span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>a</span> <span class='o'>-</span> <span class='nv'>rng</span><span class='o'>[</span><span class='m'>1</span><span class='o'>]</span><span class='o'>)</span> <span class='o'>/</span> <span class='o'>(</span><span class='nv'>rng</span><span class='o'>[</span><span class='m'>2</span><span class='o'>]</span> <span class='o'>-</span> <span class='nv'>rng</span><span class='o'>[</span><span class='m'>1</span><span class='o'>]</span><span class='o'>)</span>

<span class='nv'>rng</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>b</span><span class='o'>)</span>
<span class='nv'>df</span><span class='o'>$</span><span class='nv'>b</span> <span class='o'>&lt;-</span> <span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>b</span> <span class='o'>-</span> <span class='nv'>rng</span><span class='o'>[</span><span class='m'>1</span><span class='o'>]</span><span class='o'>)</span> <span class='o'>/</span> <span class='o'>(</span><span class='nv'>rng</span><span class='o'>[</span><span class='m'>2</span><span class='o'>]</span> <span class='o'>-</span> <span class='nv'>rng</span><span class='o'>[</span><span class='m'>1</span><span class='o'>]</span><span class='o'>)</span>

<span class='nv'>rng</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>c</span><span class='o'>)</span>
<span class='nv'>df</span><span class='o'>$</span><span class='nv'>c</span> <span class='o'>&lt;-</span> <span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>c</span> <span class='o'>-</span> <span class='nv'>rng</span><span class='o'>[</span><span class='m'>1</span><span class='o'>]</span><span class='o'>)</span> <span class='o'>/</span> <span class='o'>(</span><span class='nv'>rng</span><span class='o'>[</span><span class='m'>2</span><span class='o'>]</span> <span class='o'>-</span> <span class='nv'>rng</span><span class='o'>[</span><span class='m'>1</span><span class='o'>]</span><span class='o'>)</span>

<span class='nv'>rng</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>d</span><span class='o'>)</span>
<span class='nv'>df</span><span class='o'>$</span><span class='nv'>d</span> <span class='o'>&lt;-</span> <span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>d</span> <span class='o'>-</span> <span class='nv'>rng</span><span class='o'>[</span><span class='m'>1</span><span class='o'>]</span><span class='o'>)</span> <span class='o'>/</span> <span class='o'>(</span><span class='nv'>rng</span><span class='o'>[</span><span class='m'>2</span><span class='o'>]</span> <span class='o'>-</span> <span class='nv'>rng</span><span class='o'>[</span><span class='m'>1</span><span class='o'>]</span><span class='o'>)</span>
</code></pre>
</div>
<p>Still pretty horrible, and arguably worse since we add a line for each column.</p>
<p>How can we distill this into a function to avoid all that repetition?</p>
<p>The secret to function writing is abstracting the <em>constant</em> from the <em>variable</em>. (Using the <code>range</code> function does throw into sharper relief what is constant and what is varying at least.) The constant part is the <strong>body</strong> of the function: the template or boiler-plate you use over and over again. The variable parts are the <strong>arguments</strong> of the function. We also need to give the function a <strong>name</strong>, so we can call it and reuse it. The template for a function is then:</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="n">name</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2...</span><span class="p">)</span> <span class="p">{</span>
  <span class="o">&lt;</span><span class="n">body</span><span class="o">&gt;</span> <span class="c1"># do something with arg1, arg2</span>
<span class="p">}</span>
</code></pre></div><p>The body is the block of code you want to reuse, and it&rsquo;s contained in curly brackets <code>{...}</code>.</p>
<p>Here&rsquo;s what it looks like in this case:</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>normalize</span> <span class='o'>&lt;-</span> <span class='kr'>function</span><span class='o'>(</span><span class='nv'>x</span><span class='o'>)</span> <span class='o'>&#123;</span>
  <span class='nv'>rng</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='o'>(</span><span class='nv'>x</span><span class='o'>)</span>
  <span class='o'>(</span><span class='nv'>x</span> <span class='o'>-</span> <span class='nv'>rng</span><span class='o'>[</span><span class='m'>1</span><span class='o'>]</span><span class='o'>)</span> <span class='o'>/</span> <span class='o'>(</span><span class='nv'>rng</span><span class='o'>[</span><span class='m'>2</span><span class='o'>]</span> <span class='o'>-</span> <span class='nv'>rng</span><span class='o'>[</span><span class='m'>1</span><span class='o'>]</span><span class='o'>)</span>
<span class='o'>&#125;</span>
</code></pre>
</div>
<p>Pretty cool, right? Here <code>normalize</code> is the descriptive name we give the function.</p>
<p>We <strong>assign</strong> the function to the name using 
<a href="https://rdrr.io/r/base/assignOps.html" target="_blank" rel="noopener"><code>&lt;-</code></a> just like any other value. This means that now <code>normalize</code> is a function object, just like you create vector objects, or list or data frame objects, when you assigned them names. This is what is meant when people say &ldquo;functions are first-class citizens&rdquo; in R. Notice too that in RStudio they appear in the Global Environment in a special section, and clicking on them shows the code. This means that if you have a large file of code with many functions defined, you don&rsquo;t have to go back searching for the function definition in the code itself.</p>
<p><code>x</code> is the <strong>argument</strong> of the function. In the current case this is a data frame column vector, but we can potentially use this function on <em>any</em> vector, so let&rsquo;s not be too specific. The more generally you can write your function, the more useful it will be.</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>test_vec</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='o'>(</span><span class='m'>3</span>, <span class='m'>7</span>, <span class='nv'>pi</span>, <span class='m'>8.657</span>, <span class='m'>80</span><span class='o'>)</span>
<span class='nf'>normalize</span><span class='o'>(</span><span class='nv'>test_vec</span><span class='o'>)</span>

<span class='c'>#&gt; [1] 0.000000000 0.051948052 0.001838866 0.073467532 1.000000000</span>
</code></pre>
</div>
<p>When we <strong>call</strong> the function, the value we use in the function call is <strong>assigned</strong> to <code>x</code> and is <strong>passed in</strong> to the body of the function. So if we call the function on the first column, it gets passed in to the body, and returns the result:</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>df</span> <span class='o'>&lt;-</span> <span class='nf'>tibble</span><span class='o'>(</span>a <span class='o'>=</span> <span class='nf'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='o'>(</span><span class='m'>10</span><span class='o'>)</span><span class='o'>)</span>
<span class='nf'>normalize</span><span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>a</span><span class='o'>)</span>

<span class='c'>#&gt;  [1] 0.2178530 0.0000000 0.1413015 0.5403319 0.5080280 0.2213932 0.6130305</span>
<span class='c'>#&gt;  [8] 0.5878434 0.7390673 1.0000000</span>
</code></pre>
</div>
<p>A couple of things to note:</p>
<ul>
<li>
<p>Including that extra line <code>rng &lt;- range(x)</code> is no longer a problem, since we just type it once. If you are typing things out over and over you might prefer brevity. <em>When you write a function, you should prefer clarity.</em> It&rsquo;s good practice to break the the function down into logical steps, and name them properly. It&rsquo;s much easier for others to &lsquo;read&rsquo; your function, and much easier for you when you come back to it in a couple of years. This is the principle of making your code &lsquo;self-annotated&rsquo;.</p>
</li>
<li>
<p>There&rsquo;s something very important but rather subtle about this use of the argument. As noted in a CodeClub 12, once a <code>for</code> loop completes, the variable you&rsquo;re using <em>keeps the value it had</em> at the last iteration of the loop, which persists in the global environment. Below we&rsquo;ll compare that behavior to what happens with the function&rsquo;s <code>x</code> argument.</p>
</li>
</ul>
<p>Our original horrible code can now be rewritten as:</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>df</span><span class='o'>$</span><span class='nv'>a</span> <span class='o'>&lt;-</span> <span class='nf'>normalize</span><span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>a</span><span class='o'>)</span>
<span class='nv'>df</span><span class='o'>$</span><span class='nv'>b</span> <span class='o'>&lt;-</span> <span class='nf'>normalize</span><span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>b</span><span class='o'>)</span>
<span class='nv'>df</span><span class='o'>$</span><span class='nv'>c</span> <span class='o'>&lt;-</span> <span class='nf'>normalize</span><span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>c</span><span class='o'>)</span>
<span class='nv'>df</span><span class='o'>$</span><span class='nv'>d</span> <span class='o'>&lt;-</span> <span class='nf'>normalize</span><span class='o'>(</span><span class='nv'>df</span><span class='o'>$</span><span class='nv'>d</span><span class='o'>)</span>
</code></pre>
</div>
<p>Which is an improvement, but the real power comes from the fact that we can use our own new function in <code>for</code> loops and <code>apply</code> statements. Here is the data from the previous couple of Clubs:</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>dists_Mar4</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='o'>(</span><span class='m'>17</span>, <span class='m'>93</span>, <span class='m'>56</span>, <span class='m'>19</span>, <span class='m'>175</span>, <span class='m'>40</span>, <span class='m'>69</span>, <span class='m'>267</span>, <span class='m'>4</span>, <span class='m'>91</span><span class='o'>)</span>
<span class='nv'>dists_Mar5</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='o'>(</span><span class='m'>87</span>, <span class='m'>143</span>, <span class='m'>103</span>, <span class='m'>223</span>, <span class='m'>106</span>, <span class='m'>18</span>, <span class='m'>87</span>, <span class='m'>72</span>, <span class='m'>59</span>, <span class='m'>5</span><span class='o'>)</span>
<span class='nv'>dist_df</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='o'>(</span><span class='nv'>dists_Mar4</span>, <span class='nv'>dists_Mar5</span><span class='o'>)</span>
</code></pre>
</div>
<p>Let&rsquo;s first check that our new function behaves sensibly on these vectors, as a sanity check:</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nf'>normalize</span><span class='o'>(</span><span class='nv'>dists_Mar4</span><span class='o'>)</span>

<span class='c'>#&gt;  [1] 0.04942966 0.33840304 0.19771863 0.05703422 0.65019011 0.13688213</span>
<span class='c'>#&gt;  [7] 0.24714829 1.00000000 0.00000000 0.33079848</span>
</code></pre>
</div>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nf'>normalize</span><span class='o'>(</span><span class='nv'>dists_Mar5</span><span class='o'>)</span> 

<span class='c'>#&gt;  [1] 0.37614679 0.63302752 0.44954128 1.00000000 0.46330275 0.05963303</span>
<span class='c'>#&gt;  [7] 0.37614679 0.30733945 0.24770642 0.00000000</span>
</code></pre>
</div>
<p>And while we&rsquo;re here, let&rsquo;s circle back to the assignment of the <code>x</code> argument outside and inside the function. Below we first assign a value to <code>x</code> outside the function; pass in a value to <code>x</code> inside the function; then reevaluate <code>x</code> outside the function call, to see what happened:</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>x</span> <span class='o'>=</span> <span class='nv'>pi</span>
<span class='nv'>x</span>

<span class='c'>#&gt; [1] 3.141593</span>

<span class='nf'>normalize</span><span class='o'>(</span><span class='nv'>dists_Mar5</span><span class='o'>)</span>             <span class='c'># inside the function, x &lt;- dists_Mar5</span>

<span class='c'>#&gt;  [1] 0.37614679 0.63302752 0.44954128 1.00000000 0.46330275 0.05963303</span>
<span class='c'>#&gt;  [7] 0.37614679 0.30733945 0.24770642 0.00000000</span>

<span class='nv'>x</span>

<span class='c'>#&gt; [1] 3.141593</span>
</code></pre>
</div>
<p>Whatever value <code>x</code> has outside the function does not affect, and is not affected by, the value of <code>x</code> inside the function. In computer science terms we say the variable(s) used inside the function are <strong>local</strong> to the function. They are freshly minted inside it, and safely destroyed before you leave it. So there is no chance of weird or unexpected conflicts with whatever variable values are set outside. In contrast, the variable in the for loop is <strong>global</strong>. It &lsquo;leaks out&rsquo; from where you actually used it, with perhaps unforeseen consequences. This is extremely important when you start embedding your own functions in larger programs.</p>
<h3 id="functions-in-for-loops">Functions in <code>for</code> loops</h3>
<p>Here is how we can use our new function in a <code>for</code> loop over a data frame. In our previous examples of <code>for</code> loops <code>median</code> was a summary statistic and we return a single value for each column, so we created an empty vector of the desired length to hold the values for each column. Here we want to modify the original data frame with the same dimensions and column names. The following code copies the original data frame (so we don&rsquo;t destroy it) and then modifies it &lsquo;in place&rsquo;:</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>dist_df_norm</span> <span class='o'>&lt;-</span> <span class='nv'>dist_df</span>
<span class='kr'>for</span> <span class='o'>(</span><span class='nv'>column_number</span> <span class='kr'>in</span> <span class='m'>1</span><span class='o'>:</span><span class='nf'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='o'>(</span><span class='nv'>dist_df</span><span class='o'>)</span><span class='o'>)</span><span class='o'>&#123;</span>
  <span class='nv'>dist_df_norm</span><span class='o'>[[</span><span class='nv'>column_number</span><span class='o'>]</span><span class='o'>]</span> <span class='o'>&lt;-</span> <span class='nf'>normalize</span><span class='o'>(</span><span class='nv'>dist_df</span><span class='o'>[[</span><span class='nv'>column_number</span><span class='o'>]</span><span class='o'>]</span><span class='o'>)</span>
<span class='o'>&#125;</span>
<span class='nv'>dist_df_norm</span>

<span class='c'>#&gt;    dists_Mar4 dists_Mar5</span>
<span class='c'>#&gt; 1  0.04942966 0.37614679</span>
<span class='c'>#&gt; 2  0.33840304 0.63302752</span>
<span class='c'>#&gt; 3  0.19771863 0.44954128</span>
<span class='c'>#&gt; 4  0.05703422 1.00000000</span>
<span class='c'>#&gt; 5  0.65019011 0.46330275</span>
<span class='c'>#&gt; 6  0.13688213 0.05963303</span>
<span class='c'>#&gt; 7  0.24714829 0.37614679</span>
<span class='c'>#&gt; 8  1.00000000 0.30733945</span>
<span class='c'>#&gt; 9  0.00000000 0.24770642</span>
<span class='c'>#&gt; 10 0.33079848 0.00000000</span>
</code></pre>
</div>
<p>Copying an entire data frame so we can operate on it <em>could</em> take a lot of time. So we can also create an empty data frame (of the same dimensions) and populate it:</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>empty_vec</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rdrr.io/r/base/vector.html'>vector</a></span><span class='o'>(</span>length <span class='o'>=</span> <span class='nf'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='o'>(</span><span class='nv'>dist_df</span><span class='o'>)</span><span class='o'>)</span>
<span class='nv'>dist_df_norm_2</span> <span class='o'>&lt;-</span> <span class='nf'>tibble</span><span class='o'>(</span>norm_Mar4 <span class='o'>=</span> <span class='nv'>empty_vec</span>, norm_Mar5 <span class='o'>=</span> <span class='nv'>empty_vec</span><span class='o'>)</span>

<span class='kr'>for</span> <span class='o'>(</span><span class='nv'>column_number</span> <span class='kr'>in</span> <span class='m'>1</span><span class='o'>:</span><span class='nf'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='o'>(</span><span class='nv'>dist_df</span><span class='o'>)</span><span class='o'>)</span><span class='o'>&#123;</span>
  <span class='nv'>dist_df_norm_2</span><span class='o'>[[</span><span class='nv'>column_number</span><span class='o'>]</span><span class='o'>]</span> <span class='o'>&lt;-</span> <span class='nf'>normalize</span><span class='o'>(</span><span class='nv'>dist_df</span><span class='o'>[[</span><span class='nv'>column_number</span><span class='o'>]</span><span class='o'>]</span><span class='o'>)</span>
<span class='o'>&#125;</span>
<span class='nv'>dist_df_norm_2</span>

<span class='c'>#&gt; <span style='color: #555555;'># A tibble: 10 x 2</span></span>
<span class='c'>#&gt;    norm_Mar4 norm_Mar5</span>
<span class='c'>#&gt;        <span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>     </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span></span>
<span class='c'>#&gt; <span style='color: #555555;'> 1</span><span>    0.049</span><span style='text-decoration: underline;'>4</span><span>    0.376 </span></span>
<span class='c'>#&gt; <span style='color: #555555;'> 2</span><span>    0.338     0.633 </span></span>
<span class='c'>#&gt; <span style='color: #555555;'> 3</span><span>    0.198     0.450 </span></span>
<span class='c'>#&gt; <span style='color: #555555;'> 4</span><span>    0.057</span><span style='text-decoration: underline;'>0</span><span>    1     </span></span>
<span class='c'>#&gt; <span style='color: #555555;'> 5</span><span>    0.650     0.463 </span></span>
<span class='c'>#&gt; <span style='color: #555555;'> 6</span><span>    0.137     0.059</span><span style='text-decoration: underline;'>6</span></span>
<span class='c'>#&gt; <span style='color: #555555;'> 7</span><span>    0.247     0.376 </span></span>
<span class='c'>#&gt; <span style='color: #555555;'> 8</span><span>    1         0.307 </span></span>
<span class='c'>#&gt; <span style='color: #555555;'> 9</span><span>    0         0.248 </span></span>
<span class='c'>#&gt; <span style='color: #555555;'>10</span><span>    0.331     0</span></span>
</code></pre>
</div>
<p>By writing our own function, we&rsquo;ve effectively extended what R can do. And this is all that packages are: libraries of new functions that extend the capabilities of base R. In fact, if there are functions you design for your particular subject area and find yourself using all the time, you can make your own package and load it, and all your favorite functions will be right there (but that&rsquo;s for another day&hellip;)</p>
<h2 id="functional-programming-with-your-own-functions">Functional programming with your own functions</h2>
<p>We saw above that you assign the function object to a name, just as you would a vector, list or data frame. In R, functions are &lsquo;first class citizens&rsquo;, which means you can <strong>pass them as an arguments to another function</strong>. This is a very powerful idea, and the part of the program of <strong>functional programming</strong>.</p>
<blockquote>
<p>In functional programming, functions are treated as first-class citizens, meaning that they can be bound to names&hellip;, passed as arguments, and returned from other functions, just as any other data type can.</p>
</blockquote>
<p>Functions that can take other functions arguments are sometimes referred to as <strong>functionals</strong>.</p>
<h3 id="lapply"><code>lapply()</code></h3>
<p>We saw this functional in the previous CodeClub: it always returns a list:</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>lapply_norm</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='o'>(</span><span class='nv'>dist_df</span>, <span class='nv'>normalize</span><span class='o'>)</span>
<span class='nv'>lapply_norm</span>

<span class='c'>#&gt; $dists_Mar4</span>
<span class='c'>#&gt;  [1] 0.04942966 0.33840304 0.19771863 0.05703422 0.65019011 0.13688213</span>
<span class='c'>#&gt;  [7] 0.24714829 1.00000000 0.00000000 0.33079848</span>
<span class='c'>#&gt; </span>
<span class='c'>#&gt; $dists_Mar5</span>
<span class='c'>#&gt;  [1] 0.37614679 0.63302752 0.44954128 1.00000000 0.46330275 0.05963303</span>
<span class='c'>#&gt;  [7] 0.37614679 0.30733945 0.24770642 0.00000000</span>

<span class='nf'><a href='https://rdrr.io/r/base/typeof.html'>typeof</a></span><span class='o'>(</span><span class='nv'>lapply_norm</span><span class='o'>)</span>

<span class='c'>#&gt; [1] "list"</span>

<span class='nf'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='o'>(</span><span class='nv'>lapply_norm</span><span class='o'>)</span>

<span class='c'>#&gt; List of 2</span>
<span class='c'>#&gt;  $ dists_Mar4: num [1:10] 0.0494 0.3384 0.1977 0.057 0.6502 ...</span>
<span class='c'>#&gt;  $ dists_Mar5: num [1:10] 0.376 0.633 0.45 1 0.463 ...</span>
</code></pre>
</div>
<p>
<a href="https://rdrr.io/r/base/lapply.html" target="_blank" rel="noopener"><code>sapply()</code></a> attempts to simplify the outputs. Here both lists are of type <code>num</code>, and the same length, so we could simplify to a matrix data structure of a single type:</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>sapply_norm</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='o'>(</span><span class='nv'>dist_df</span>, <span class='nv'>normalize</span><span class='o'>)</span>
<span class='nv'>sapply_norm</span>

<span class='c'>#&gt;       dists_Mar4 dists_Mar5</span>
<span class='c'>#&gt;  [1,] 0.04942966 0.37614679</span>
<span class='c'>#&gt;  [2,] 0.33840304 0.63302752</span>
<span class='c'>#&gt;  [3,] 0.19771863 0.44954128</span>
<span class='c'>#&gt;  [4,] 0.05703422 1.00000000</span>
<span class='c'>#&gt;  [5,] 0.65019011 0.46330275</span>
<span class='c'>#&gt;  [6,] 0.13688213 0.05963303</span>
<span class='c'>#&gt;  [7,] 0.24714829 0.37614679</span>
<span class='c'>#&gt;  [8,] 1.00000000 0.30733945</span>
<span class='c'>#&gt;  [9,] 0.00000000 0.24770642</span>
<span class='c'>#&gt; [10,] 0.33079848 0.00000000</span>

<span class='nf'><a href='https://rdrr.io/r/base/typeof.html'>typeof</a></span><span class='o'>(</span><span class='nv'>sapply_norm</span><span class='o'>)</span>

<span class='c'>#&gt; [1] "double"</span>

<span class='nf'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='o'>(</span><span class='nv'>sapply_norm</span><span class='o'>)</span>

<span class='c'>#&gt; [1] 10  2</span>

<span class='nf'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='o'>(</span><span class='nv'>sapply_norm</span><span class='o'>)</span>

<span class='c'>#&gt;  num [1:10, 1:2] 0.0494 0.3384 0.1977 0.057 0.6502 ...</span>
<span class='c'>#&gt;  - attr(*, "dimnames")=List of 2</span>
<span class='c'>#&gt;   ..$ : NULL</span>
<span class='c'>#&gt;   ..$ : chr [1:2] "dists_Mar4" "dists_Mar5"</span>
</code></pre>
</div>
<p>The first is a named list, the second a named matrix.</p>
<h3 id="map"><code>map()</code></h3>
<p>The functional <code>map()</code> from the <strong>purrr</strong> package behaves the same as 
<a href="https://rdrr.io/r/base/lapply.html" target="_blank" rel="noopener"><code>lapply()</code></a>, it always returns a list:</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>map_norm</span> <span class='o'>&lt;-</span> <span class='nf'>map</span><span class='o'>(</span><span class='nv'>dist_df</span>, <span class='nv'>normalize</span><span class='o'>)</span>
<span class='nv'>map_norm</span>

<span class='c'>#&gt; $dists_Mar4</span>
<span class='c'>#&gt;  [1] 0.04942966 0.33840304 0.19771863 0.05703422 0.65019011 0.13688213</span>
<span class='c'>#&gt;  [7] 0.24714829 1.00000000 0.00000000 0.33079848</span>
<span class='c'>#&gt; </span>
<span class='c'>#&gt; $dists_Mar5</span>
<span class='c'>#&gt;  [1] 0.37614679 0.63302752 0.44954128 1.00000000 0.46330275 0.05963303</span>
<span class='c'>#&gt;  [7] 0.37614679 0.30733945 0.24770642 0.00000000</span>

<span class='nf'><a href='https://rdrr.io/r/base/typeof.html'>typeof</a></span><span class='o'>(</span><span class='nv'>map_norm</span><span class='o'>)</span>

<span class='c'>#&gt; [1] "list"</span>

<span class='nf'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='o'>(</span><span class='nv'>map_norm</span><span class='o'>)</span>

<span class='c'>#&gt; List of 2</span>
<span class='c'>#&gt;  $ dists_Mar4: num [1:10] 0.0494 0.3384 0.1977 0.057 0.6502 ...</span>
<span class='c'>#&gt;  $ dists_Mar5: num [1:10] 0.376 0.633 0.45 1 0.463 ...</span>
</code></pre>
</div>
<p>Notice another advantage of both 
<a href="https://rdrr.io/r/base/lapply.html" target="_blank" rel="noopener"><code>lapply()</code></a> and <code>map()</code> <em>we don&rsquo;t need to explicitly preallocate any kind of data structure to collect the results</em>. The allocation is done behind the scenes as part of the implementation of 
<a href="https://rdrr.io/r/base/lapply.html" target="_blank" rel="noopener"><code>lapply()</code></a> and <code>map()</code>, which makes sure they run efficiently. In fact, R implements these functionals as a <code>for</code> loop behind the scenes, and in <code>map()</code> that <code>for</code> loop is implemented in C, so it optimizes performance.</p>
<p>If we want the output to be a data frame to match the input, we can simply <strong>coerce</strong> it:</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>map_norm_df</span> <span class='o'>&lt;-</span> <span class='nf'>map</span><span class='o'>(</span><span class='nv'>dist_df</span>, <span class='nv'>normalize</span><span class='o'>)</span> <span class='o'>%&gt;%</span> 
  <span class='nv'>as_tibble</span>
<span class='nf'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='o'>(</span><span class='nv'>map_norm_df</span><span class='o'>)</span>

<span class='c'>#&gt; tibble [10 × 2] (S3: tbl_df/tbl/data.frame)</span>
<span class='c'>#&gt;  $ dists_Mar4: num [1:10] 0.0494 0.3384 0.1977 0.057 0.6502 ...</span>
<span class='c'>#&gt;  $ dists_Mar5: num [1:10] 0.376 0.633 0.45 1 0.463 ...</span>
</code></pre>
</div>
<h3 id="advantages-of-using-functions">Advantages of using functions</h3>
<p>Functions:</p>
<ul>
<li>avoid duplication, save time</li>
<li>avoid coding errors in repetitive code</li>
<li>localize variables, avoiding unexpected assignment surprises</li>
<li>let you modify code in a single place, not multiple places</li>
<li>lets you reuse code, since a single function can often be used on multiple inputs (vectors, lists and data frames), and can be imported from a package, instead of copy and paste.</li>
</ul>

      </div>

      <br>

      







<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://biodash.github.io/codeclub/14_functions/&amp;text=Session%2014:%20Writing%20your%20own%20functions" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://biodash.github.io/codeclub/14_functions/&amp;t=Session%2014:%20Writing%20your%20own%20functions" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Session%2014:%20Writing%20your%20own%20functions&amp;body=https://biodash.github.io/codeclub/14_functions/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https://biodash.github.io/codeclub/14_functions/&amp;title=Session%2014:%20Writing%20your%20own%20functions" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=Session%2014:%20Writing%20your%20own%20functions%20https://biodash.github.io/codeclub/14_functions/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https://biodash.github.io/codeclub/14_functions/&amp;title=Session%2014:%20Writing%20your%20own%20functions" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>












  
    
    





  
  
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <img class="avatar mr-3 avatar-circle" src="/authors/michael-broe/avatar_hu13632d739ac05d9f7c100f25ef9127c7_976850_270x270_fill_q90_lanczos_center.jpg" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title"><a href="/authors/michael-broe/">Michael Broe</a></h5>
      <h6 class="card-subtitle">Bioinformatician at EEOB</h6>
      
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
    <li>
      <a href="mailto:broe.1@osu.edu" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/michaelbroe" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>


  










  
  


    
      <br>
      
      <hr class="separator">

          <div class="clearfix">
          
              
                  <span class="previous-link">
                      <a href="https://biodash.github.io/codeclub/13_apply/">← Session 13: Applying The Apply Functions</a>
                  </span>
              
          
          
      </div>
      
      <hr class="separator">

    </div>
  
  </article>

  
  </main>
  </div>
  </div>
  

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = false;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
      
    
    
    
    <script src="/js/academic.min.bcd76b45b3121e56162b93ef7b3f1eee.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
    
    <p class="powered-by">
      <a href="/license/">LICENSE: CC-BY-SA <br> <i class="fab fa-creative-commons fa-2x"></i><i class="fab fa-creative-commons-by fa-2x"></i><i class="fab fa-creative-commons-sa fa-2x"></i> </a><br>
    </p>
    
</footer>
  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
